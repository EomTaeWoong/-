<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>통신사폰 계산기</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-slate-50">
<div id="root"></div>

<script type="text/babel">
const { useState, useMemo } = React;

// 월 할부 계산 함수
function pmt(rate, nper, pv) {
  if(rate===0) return pv/nper;
  return (rate*pv)/(1-Math.pow(1+rate, -nper));
}

// ------------------ 단말기 ------------------
const DEVICE_LIST = [
  { name: '폴드7 256기가', price: 2379300 },
  { name: '폴드7 512기가', price: 2537700 },
  { name: '플립7 256기가', price: 1485000 },
  { name: '플립7 512기가', price: 1643400 },
  { name: 'S25 엣지 256기가', price: 1496000 },
  { name: 'S25 엣지 512기가', price: 1639000 },
  { name: 'S25 울트라 256기가', price: 1698400 },
  { name: 'S25 플러스 256기가', price: 1353000 },
  { name: 'S25 256기가', price: 1155000 },
  { name: 'S24 FE', price: 946000 },
  { name: 'A36 5G 128기가', price: 499400 },
  { name: 'A16 LTE 128기가', price: 319000 }
];

// ------------------ KT 요금제 ------------------
const PLAN_LIST_KT = [
  { category: 'LTE', name: 'LTE 베이직', price: 33000 },
  { category: 'LTE', name: 'LTE Y베이직', price: 33000 },
  { category: 'LTE', name: '데이터ON 톡 플러스(신규가입 중단)', price: 49000 },
  { category: 'LTE', name: '데이터ON 비디오 플러스(신규가입 중단)', price: 69000 },
  { category: 'LTE', name: 'LTE 슬림 플러스(신규가입 중단)', price: 61000 },
  { category: 'LTE', name: 'LTE 베이직 플러스(신규가입 중단)', price: 44000 },
  { category: 'LTE', name: 'LTE 안심데이터 38.5(신규가입 중단)', price: 38500 },
  { category: 'LTE', name: '데이터ON 비디오 플러스', price: 69000 },
  { category: 'LTE', name: '데이터ON 프리미엄', price: 89000 },

  { category: '5G 시니어', name: '5G 시니어 베이직', price: 49000 },
  { category: '5G 시니어', name: '5G 시니어 A형', price: 44000 },
  { category: '5G 시니어', name: '5G 시니어 B형', price: 42000 },
  { category: '5G 시니어', name: '5G 시니어 C형', price: 41000 },

  { category: 'Y', name: '5G Y틴', price: 47000 },
  { category: 'Y', name: '5G Y슬림', price: 55000 },
  { category: 'Y', name: '5G Y베이직', price: 80000 },
  { category: 'Y', name: '5G Y스페셜', price: 100000 },

  { category: '5G', name: '5G 슬림 4GB', price: 37000 },
  { category: '5G', name: '5G 슬림 7GB', price: 45000 },
  { category: '5G', name: '5G 슬림 10GB', price: 50000 },
  { category: '5G', name: '5G 슬림 14GB', price: 55000 },
  { category: '5G', name: '5G 슬림 21GB', price: 58000 },
  { category: '5G', name: '5G 심플 30GB', price: 61000 },
  { category: '5G', name: '5G 심플 50GB', price: 63000 },
  { category: '5G', name: '5G 심플 70GB', price: 65000 },
  { category: '5G', name: '5G 심플 90GB', price: 67000 },
  { category: '5G', name: '5G 심플 110GB', price: 69000 },
  { category: '5G', name: '5G 베이직', price: 80000 },
  { category: '5G', name: '5G 스페셜', price: 100000 },
  { category: '5G', name: '5G 초이스 베이직', price: 90000 },
  { category: '5G', name: '5G 초이스 스페셜', price: 110000 },
  { category: '5G', name: '5G 초이스 프리미엄', price: 130000 },
];

// KT 요금제 특징
const PLAN_FEATURES_KT = {
  'LTE 베이직':'1.4GB + Qos',
  'LTE Y베이직':'2.5GB + Qos',
  '데이터ON 톡 플러스(신규가입 중단)':'3GB + 1Mbps',
  '데이터ON 비디오 플러스(신규가입 중단)':'100GB + 5Mbps',
  'LTE 슬림 플러스(신규가입 중단)':'30GB + 1Mbps',
  'LTE 베이직 플러스(신규가입 중단)':'3GB + 400Kbps',
  'LTE 안심데이터 38.5(신규가입 중단)':'450MB + 400Kbps',
  '데이터ON 비디오 플러스':'110GB + 5Mbps',
  '데이터ON 프리미엄':'완전 무제한/스마트기기 1회선 무료VIP/필수팩 L3(지니/밀리) 무료/단말보험 멤버십 포인트 최대 4,500P 차감',
  '5G 시니어 베이직':'15GB + 1Mbps/만 65세 이상',
  '5G 시니어 A형':'10GB + 1Mbps/만 65세 이상',
  '5G 시니어 B형':'9GB + 1Mbps/만 75세 이상',
  '5G 시니어 C형':'8GB + 1Mbps/만 80세 이상',
  '5G Y틴':'10GB + 1Mbps',
  '5G Y슬림':'14GB + 1Mbps/로밍 데이터 속도 100Kbps',
  '5G Y베이직':'완전 무제한/스마트기기 1회선 50% 할인(Y덤)/로밍 데이터 속도 1Mbps/VIP',
  '5G Y스페셜':'완전 무제한/스마트기기 1회선 무료/로밍 데이터 속도 1Mbps/VVIP/단말보험 멤버십 포인트 최대 4,500P 차감',
  '5G 슬림 4GB':'400Kbps',
  '5G 슬림 7GB':'400Kbps',
  '5G 슬림 10GB':'400Kbps',
  '5G 슬림 14GB':'1Mbps',
  '5G 슬림 21GB':'1Mbps',
  '5G 심플 30GB':'1Mbps',
  '5G 심플 50GB':'1Mbps',
  '5G 심플 70GB':'1Mbps',
  '5G 심플 90GB':'1Mbps',
  '5G 심플 110GB':'5Mbps',
  '5G 베이직':'완전 무제한/만 34세 이하 스마트기기 1회선 50% 할인(Y덤)/로밍 데이터 속도 100Kbps/VIP',
  '5G 스페셜':'완전 무제한/스마트기기 1회선 무료/로밍 데이터 속도 100Kbps/VVIP/단말보험 멤버십 포인트 최대 4,500P 차감',
  '5G 초이스 베이직':'유튜브 선택시 월 4,450원 추가',
  '5G 초이스 스페셜':'유튜브 선택시 월 4,450원 추가',
  '5G 초이스 프리미엄':'유튜브 선택시 월 4,450원 추가'
};

// ------------------ U+ 요금제 ------------------
const PLAN_LIST_U = [
  { category: 'LTE', name: '데이터 일반(신규가입 중단)', price: 32890 },
  { category: 'LTE', name: '데이터 1.3(신규가입 중단)', price: 39490 },
  { category: 'LTE', name: '데이터 2.3(신규가입 중단)', price: 46090 },
  { category: 'LTE', name: '데이터 3.6(신규가입 중단)', price: 51590 },
  { category: 'LTE', name: '데이터 6.6(신규가입 중단)', price: 55990 },
  { category: 'LTE', name: '스페셜 A(신규가입 중단)', price: 65890 },
  { category: 'LTE', name: '스페셜 B(신규가입 중단)', price: 74800 },
  { category: 'LTE', name: 'LTE 데이터33', price: 33000 },
  { category: 'LTE', name: 'LTE 추걱데44(신규가입 중단)', price: 44000 },
  { category: 'LTE', name: 'LTE 추걱데49(신규가입 중단)', price: 49000 },
  { category: 'LTE', name: 'LTE 추걱데59(신규가입 중단)', price: 59000 },
  { category: 'LTE', name: 'LTE 추걱데69(신규가입 중단)', price: 69000 },
  { category: 'LTE', name: 'LTE 속걱데78(신규가입 중단)', price: 78000 },
  { category: 'LTE', name: 'LTE 속걱데88(신규가입 중단)', price: 88000 },
  { category: 'LTE', name: 'LTE 프리미어 에센셜(신규가입 중단)', price: 85000 },
  { category: 'LTE', name: 'LTE 프리미어 플러스(신규가입 중단)', price: 105000 },
  { category: '5G', name: '5G 미니', price: 37000 },
  { category: '5G', name: '5G 슬림+', price: 47000 },
  { category: '5G', name: '5G 라이트+', price: 55000 },
  { category: '5G', name: '5G 베이직+', price: 59000 },
  { category: '5G', name: '5G 심플+', price: 61000 },
  { category: '5G', name: '5G 데이터 레귤러', price: 63000 },
  { category: '5G', name: '5G 데이터 플러스', price: 66000 },
  { category: '5G', name: '5G 데이터 슈퍼', price: 68000 },
  { category: '5G', name: '5G 스탠다드 에센셜', price: 70000 },
  { category: '5G', name: '5G 스탠다드', price: 75000 },
  { category: '5G', name: '5G 프리미어 에센셜', price: 85000 },
  { category: '5G', name: '5G 프리미어 레귤러', price: 95000 },
  { category: '5G', name: '5G 프리미어 플러스', price: 105000 },
  { category: '5G', name: '5G 프리미어 슈퍼', price: 115000 },
  { category: '5G', name: '5G 시그니처', price: 130000 }
];

const PLAN_FEATURES_U = {
  '데이터 일반':'300MB',
  '데이터 1.3':'1.3GB',
  '데이터 2.3':'2.3GB',
  '데이터 3.6':'3.6GB',
  '데이터 6.6':'6.6GB',
  '데이터 스페셜 A':'11GB + 일 2GB + 3Mbps',
  '데이터 스페셜 B':'16GB + 일 2GB + 3Mbps',
  'LTE 데이터33':'1.5GB + 종량과금',
  'LTE 추걱데44':'2.5GB + 400Kbps',
  'LTE 추걱데49':'3.5GB + 1Mbps',
  'LTE 추걱데59':'6.6GB + 1Mbps',
  'LTE 추걱데69':'일 5GB + 5Mbps',
  'LTE 속걱데78':'무제한',
  'LTE 속걱데88':'무제한/스마트기기 2회선 무료',
  'LTE 프리미어 에센셜':'무제한',
  'LTE 프리미어 플러스':'무제한/스마트기기 2회선 무료',
  '5G 미니':'5GB + 400Kbps/유쓰 데이터 제공량 9GB',
  '5G 슬림+':'9GB + 400Kbps/유쓰 데이터 제공량 15GB',
  '5G 라이트+':'14GB + 1Mbps/유쓰 데이터 제공량 26GB',
  '5G 베이직+':'24GB + 1Mbps/유쓰 데이터 제공량 36GB',
  '5G 심플+':'31GB + 1Mbps/유쓰 데이터 제공량 41GB',
  '5G 데이터 레귤러':'50GB + 1Mbps/유쓰 데이터 제공량 70GB',
  '5G 데이터 플러스':'80GB + 1Mbps/유쓰 데이터 제공량 110GB',
  '5G 데이터 슈퍼':'95GB + 3Mbps/유쓰 데이터 제공량 135GB',
  '5G 스탠다드 에센셜':'125GB + 5Mbps/유쓰 데이터 제공량 185GB',
  '5G 스탠다드':'150GB + 5Mbps/유쓰 데이터 제공량 210GB',
  '5G 프리미어 에센셜':'무제한',
  '5G 프리미어 레귤러':'무제한/스마트기기 요금할인 11,000원(1대)',
  '5G 프리미어 플러스':'무제한/스마트기기 요금할인 11,000원(2대)',
  '5G 프리미어 슈퍼':'무제한/스마트기기 요금할인 11,000원(2대)',
  '5G 시그니처':'무제한/스마트기기 요금할인 11,000원(2대)/미성년자 휴대폰 1대 33,000원 할인'
};

// ------------------ 계산기 컴포넌트 ------------------
function Calculator({ plans, features }) {
  const [selectedDevice, setSelectedDevice] = useState(DEVICE_LIST[0].name);
  const [selectedPlan, setSelectedPlan] = useState(plans[0].name);
  const [installMonths, setInstallMonths] = useState(24);
  const [interestRate] = useState(0.059);
  const [commonSupport, setCommonSupport] = useState(300000);
  const [additionalSupport, setAdditionalSupport] = useState(0);
  const [contractType, setContractType] = useState('공통지원');

  const devicePrice = useMemo(()=> DEVICE_LIST.find(d=>d.name===selectedDevice)?.price || 0, [selectedDevice]);

  const monthlyDevice = useMemo(()=>{
    if(installMonths===0) return 0;
    const totalPrice = devicePrice - (contractType==='선택약정'?0:commonSupport) - additionalSupport;
    return Math.round(pmt(interestRate/12, installMonths, totalPrice));
  }, [devicePrice, installMonths, commonSupport, additionalSupport, contractType]);

  const planPrice = useMemo(()=>{
    let price = plans.find(p=>p.name===selectedPlan)?.price || 0;
    if(contractType==='선택약정') price = Math.round(price * 0.75);
    return price;
  }, [selectedPlan, plans, contractType]);

  const totalMonthly = monthlyDevice + planPrice;
  const featureText = features[selectedPlan] || '';
  const totalSupport = contractType==='선택약정'?0:commonSupport + additionalSupport;
  const finalDevicePrice = devicePrice - (contractType==='선택약정'?0:totalSupport);

  return (
    <div className="p-4 max-w-4xl mx-auto">
      <div className="mb-4 flex flex-wrap gap-4">
        <select value={selectedDevice} onChange={e=>setSelectedDevice(e.target.value)} className="border p-2 rounded flex-1">
          {DEVICE_LIST.map(d=><option key={d.name} value={d.name}>{d.name} ({d.price.toLocaleString()}원)</option>)}
        </select>

        <select value={selectedPlan} onChange={e=>setSelectedPlan(e.target.value)} className="border p-2 rounded flex-1">
          {['LTE','5G 시니어','Y','5G'].map(cat=>{
            const filtered = plans.filter(p=>p.category===cat);
            if(filtered.length===0) return null;
            return (
              <optgroup key={cat} label={cat}>
                {filtered.map(p=><option key={p.name} value={p.name}>{p.name} ({p.price.toLocaleString()}원)</option>)}
              </optgroup>
            );
          })}
        </select>

        <select value={installMonths} onChange={e=>setInstallMonths(Number(e.target.value))} className="border p-2 rounded w-32">
          {[0,6,12,18,24,30,36,48].map(m=><option key={m} value={m}>{m===0?'일시불':m+'개월'}</option>)}
        </select>
      </div>

      <div className="mb-4 flex gap-4">
        <div className="flex flex-col">
          <label className="text-sm">공통지원금</label>
          <input type="number" value={contractType==='선택약정'?0:commonSupport} disabled={contractType==='선택약정'} onChange={e=>setCommonSupport(Number(e.target.value))} className="border p-1 rounded w-32"/>
        </div>
        <div className="flex flex-col">
          <label className="text-sm">추가지원금</label>
          <input type="number" value={additionalSupport} onChange={e=>setAdditionalSupport(Number(e.target.value))} className="border p-1 rounded w-32"/>
        </div>
        <div className="flex flex-col">
          <label className="text-sm">약정</label>
          <select value={contractType} onChange={e=>setContractType(e.target.value)} className="border p-1 rounded w-32">
            <option value="공통지원">공통지원</option>
            <option value="선택약정">선택약정</option>
          </select>
        </div>
      </div>

      <div className="border p-4 rounded bg-white shadow-md flex flex-col gap-2">
        <div className="text-green-600 font-bold text-xl">단말기 가격: {devicePrice.toLocaleString()}원</div>
        <div>월 단말기 할부금: {monthlyDevice.toLocaleString()}원</div>
        <div>월 요금제: {planPrice.toLocaleString()}원 ({featureText})</div>
        <div className="text-red-600 font-bold text-2xl">총 월 납부금: {totalMonthly.toLocaleString()}원</div>
        <div>총 지원금 적용 후 단말기 실 납부금: {finalDevicePrice.toLocaleString()}원</div>
      </div>
    </div>
  );
}

// ------------------ 렌더링 ------------------
function App() {
  const [operator, setOperator] = useState('KT');

  const plans = useMemo(()=> operator==='KT'?PLAN_LIST_KT:PLAN_LIST_U, [operator]);
  const features = useMemo(()=> operator==='KT'?PLAN_FEATURES_KT:PLAN_FEATURES_U, [operator]);

  return (
    <div>
      <div className="p-4 max-w-4xl mx-auto flex gap-4">
        <button className={`p-2 rounded ${operator==='KT'?'bg-blue-600 text-white':'bg-white border'}`} onClick={()=>setOperator('KT')}>KT</button>
        <button className={`p-2 rounded ${operator==='U'?'bg-green-600 text-white':'bg-white border'}`} onClick={()=>setOperator('U')}>U+</button>
      </div>
      <Calculator plans={plans} features={features}/>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App/>);

</script>
</body>
</html>
